# نظام المعمل الطبي - MedLab

نظام متكامل لإدارة المختبرات الطبية، يساعد في تنظيم العمل وإدارة المرضى والتحاليل والنتائج بشكل فعال.

<div align="center">
  <img src="public/logo.png" alt="MedLab Logo" width="200">
</div>

## ✨ الميزات الرئيسية

- 👥 **إدارة المرضى**: تسجيل المرضى وتعديل بياناتهم وعرض سجلاتهم الطبية
- 🔬 **إدارة التحاليل**: تسجيل التحاليل وأسعارها وتفاصيلها
- 🧪 **إدارة العينات**: تتبع العينات المأخوذة من المرضى ونتائجها
- 💰 **الفواتير والمدفوعات**: إصدار الفواتير وإدارة المدفوعات
- 📋 **نظام الطابور**: إدارة قائمة الانتظار وأولوية المرضى
- 📈 **التقارير**: إنشاء تقارير مختلفة عن المرضى والتحاليل والإيرادات
- 👮 **نظام الصلاحيات**: تحديد صلاحيات المستخدمين حسب أدوارهم

## 🚀 التقنيات المستخدمة

- **Next.js 15**: إطار عمل React للتطبيقات الحديثة
- **TypeScript**: للكتابة البرمجية الآمنة والذكية
- **Prisma ORM**: لإدارة قاعدة البيانات بطريقة سهلة وآمنة
- **MySQL**: لتخزين البيانات
- **Tailwind CSS**: لتنسيق الواجهة بشكل مرن وسريع
- **React Query**: لإدارة حالة البيانات في واجهة المستخدم
- **NextAuth.js/JWT**: للمصادقة وإدارة الجلسات
- **JOSE**: لإدارة التوكنات JWT
- **Zod**: للتحقق من البيانات

## 🛠️ متطلبات النظام

- Node.js v18.17 أو أعلى
- MySQL8.0 أو أعلى
- npm أو yarn أو pnpm

## ⚙️ طريقة الإعداد والتشغيل

### 1. تثبيت اعتماديات المشروع

```bash
npm install
```

### 2. إعداد ملف البيئة

قم بإنشاء ملف `.env` في المجلد الرئيسي للمشروع واضبط المتغيرات التالية:

```
# قاعدة البيانات
DATABASE_URL="mysql://username:password@localhost:3306/اسم قاعدة البيانات"

# JWT
JWT_SECRET="هنا نولد توكين من اي موقع موثوق"
الفائدة الأساسية من الـ (JWT_SECRET) هي
أمان: حماية من التلاعب بالتوكنات
تحقق من الأصالة: ضمان أن التوكن جاء من مصدر موثوق.

# الإعدادات العامة
NEXT_PUBLIC_BASE_URL="http://localhost:3000"
```

### 3. تهيئة قاعدة البيانات

```bash
npx prisma db push
```

### 4. إنشاء بيانات أولية (اختياري)

```bash
npx prisma db seed
```

### 5. تشغيل المشروع في وضع التطوير

```bash
npm run dev
# أو
yarn dev
# أو
pnpm dev
```

### 6. الوصول للتطبيق

افتح المتصفح على العنوان التالي:

```
http://localhost:3000
```

## 🧑‍💻 الأدوار في النظام

1. **المدير (ADMIN)**: جميع الصلاحيات في النظام
2. **موظف الاستقبال (RECEPTIONIST)**: إدارة المرضى والطابور
3. **فني المختبر (LAB_TECHNICIAN)**: إدارة العينات والتحاليل
4. **المحاسب (ACCOUNTANT)**: إدارة الفواتير والمدفوعات والتقارير المالية

## 🌐 واجهات API الرئيسية

- **المصادقة**: `/api/auth/*`
- **المرضى**: `/api/patients/*`
- **التحاليل**: `/api/tests/*`
- **العينات**: `/api/samples/*`
- **الفواتير**: `/api/invoices/*`
- **تذكرة إنتظار**: `/api/queue/*`
- **التقارير**: `/api/reports/*`

## 🧪 الاختبارات

لتشغيل الاختبارات:

```bash
npm run test
# أو
yarn test
# أو
pnpm test
```

## 🏭 النشر للإنتاج

لبناء المشروع للإنتاج:

```bash
npm run build
# أو
yarn build
# أو
pnpm build
```

ثم لتشغيل النسخة المبنية:

```bash
npm run start
# أو
yarn start
# أو
pnpm start
```

لتشغيل نسخة التطوير

```bash
npm run dev
# أو
yarn dev
# أو
pnpm dev
```

## 📋 التوصيات والتحسينات

راجع ملف [التوصيات](./RECOMMENDATIONS.md) للاطلاع على التحسينات المقترحة للمشروع.

## 📜 الترخيص

هذا المشروع ملكية خاصة لـ **Lilas and Rama**. لا يُسمح بإعادة توزيع أو استخدام أي جزء من المشروع بدون إذن مسبق.

جميع الحقوق محفوظة.

## ✉️ التواصل

## تشغيل المشروع باستخدام Docker

### المتطلبات

- تثبيت [Docker](https://docs.docker.com/get-docker/)
- تثبيت [Docker Compose](https://docs.docker.com/compose/install/)

### البدء بسرعة

1. انسخ ملف إلى `.env`:

```bash
cp .env .env
```

2. قم بتشغيل الخدمات باستخدام Docker Compose:

```bash
docker-compose up -d
```

هذا سيقوم بتشغيل:

- خدمة MySQL على المنفذ 3306
- خدمة PHPMyAdmin على المنفذ 8080
- تطبيق Next.js على المنفذ 3000

3. الوصول إلى التطبيق:
   - واجهة التطبيق: http://localhost:3000
   - واجهة إدارة قاعدة البيانات (PHPMyAdmin): http://localhost:8080
     - اسم المستخدم: root
     - كلمة المرور: rootpassword

### أوامر Docker المفيدة

#### مشاهدة سجلات الخدمات:

```bash
# مشاهدة سجلات جميع الخدمات
docker-compose logs

# مشاهدة سجلات خدمة محددة
docker-compose logs app
docker-compose logs db
```

#### إيقاف الخدمات:

```bash
docker-compose down
```

#### إعادة بناء التطبيق بعد إجراء تغييرات:

```bash
docker-compose build app
docker-compose up -d
```

#### تنفيذ أوامر Prisma:

```bash
# توليد العميل
docker-compose exec app npx prisma generate

# تطبيق الترحيلات
docker-compose exec app npx prisma migrate dev

# فتح استوديو Prisma
docker-compose exec app npx prisma studio
```

### استخدام قاعدة البيانات فقط

إذا كنت ترغب في تشغيل قاعدة البيانات فقط واستخدام التطبيق محلياً:

```bash
# تشغيل قاعدة البيانات فقط
docker-compose up -d db phpmyadmin
```

ثم قم بتعديل ملف `.env` للتطبيق المحلي:

```
DATABASE_URL="mysql://root:rootpassword@localhost:3306/medlab"

```

قم بتشغيل التطبيق محلياً:

```bash
npm run dev
```
