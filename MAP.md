## الهيكل العام للمشروع

```
medlab/
├── src/               # المصدر الرئيسي للكود
│   ├── app/           # صفحات التطبيق (Next.js App Router)
│   ├── components/    # مكونات واجهة المستخدم
│   ├── lib/           # مكتبات وأدوات مساعدة
│   ├── types/         # تعريفات الأنواع (TypeScript)
│   ├── middleware.ts  # الوسيط لمعالجة الطلبات
│   ├── services/      # خدمات التطبيق
│   └── generated/     # الملفات المولدة تلقائياً
├── prisma/            # قاعدة البيانات (Prisma ORM)
│   ├── schema.prisma  # تعريف نماذج قاعدة البيانات
│   └── migrations/    # ترحيلات قاعدة البيانات
├── public/            # الملفات العامة
└── assets/            # الأصول (صور، أيقونات، الخ)
```

## صفحات التطبيق (App Router)

```
src/app/
├── page.tsx                # الصفحة الرئيسية
├── layout.tsx              # التخطيط الأساسي للتطبيق
├── globals.css             # أنماط CSS العامة
├── api/                    # واجهات برمجة التطبيق (API Routes)
│   ├── auth/               # المصادقة
│   ├── patients/           # المرضى
│   ├── tests/              # الفحوصات
│   ├── samples/            # العينات
│   ├── invoices/           # الفواتير
│   ├── queue/              # قائمة الانتظار
│   ├── reports/            # التقارير
│   ├── dashboard/          # لوحة التحكم
│   └── notifications/      # الإشعارات
├── auth/                   # صفحات المصادقة
├── patients/               # صفحات إدارة المرضى
│   ├── page.tsx            # قائمة المرضى
│   ├── new/                # إضافة مريض جديد
│   └── [id]/               # تفاصيل وتعديل مريض محدد
├── tests/                  # صفحات إدارة الفحوصات
├── samples/                # صفحات إدارة العينات
├── invoices/               # صفحات إدارة الفواتير
│   ├── page.tsx            # قائمة الفواتير
│   ├── new/                # إنشاء فاتورة جديدة
│   └── [id]/               # تفاصيل وتعديل فاتورة
├── queue/                  # صفحات إدارة قائمة الانتظار
├── reports/                # صفحات التقارير
├── dashboard/              # لوحة التحكم
└── (dashboard)/            # مجموعة صفحات لوحة التحكم
```

## المكونات (Components)

```
src/components/
├── ui/                     # مكونات واجهة المستخدم الأساسية
│   ├── button.tsx          # زر
│   ├── card.tsx            # بطاقة
│   ├── dialog.tsx          # مربع حوار
│   ├── tabs.tsx            # علامات تبويب
│   ├── DateDisplay.tsx     # عرض التاريخ
│   └── use-toast.tsx       # إشعارات
├── auth/                   # مكونات المصادقة
├── patients/               # مكونات إدارة المرضى
│   └── PatientsFilters.tsx # فلاتر المرضى
├── tests/                  # مكونات الفحوصات
├── samples/                # مكونات العينات
├── invoices/               # مكونات الفواتير
├── queue/                  # مكونات قائمة الانتظار
├── reports/                # مكونات التقارير
├── notifications/          # مكونات الإشعارات
├── layout/                 # مكونات التخطيط
├── common/                 # مكونات مشتركة
└── LoadingSpinner.tsx      # مؤشر التحميل
```

## المكتبات والأدوات المساعدة (Lib)

```
src/lib/
├── api/                    # وظائف مساعدة للـ API
├── auth/                   # وظائف المصادقة
├── prisma/                 # مساعدات Prisma
├── utils/                  # أدوات متنوعة
└── utils.ts                # وظائف مساعدة عامة
```

## نماذج البيانات (Schema)

النماذج الرئيسية في قاعدة البيانات:

- **User**: المستخدمون (الأدوار: ADMIN, RECEPTIONIST, LAB_TECHNICIAN, ACCOUNTANT)
- **Patient**: المرضى
- **Test**: الفحوصات المتاحة في المختبر
- **TestAssignment**: تعيين الفحوصات للمرضى
- **Sample**: العينات التي تم جمعها
- **Invoice**: الفواتير
- **InvoiceItem**: عناصر الفاتورة
- **QueueNumber**: أرقام قائمة الانتظار
- **Report**: التقارير

## التقنيات المستخدمة

- **الإطار الرئيسي**: Next.js 15.3.1
- **لغة البرمجة**: TypeScript
- **واجهة المستخدم**: React 19.0.0
- **تنسيق واجهة المستخدم**: Tailwind CSS 4.1.5
- **قاعدة البيانات**: MySQL (عبر Prisma ORM)
- **المصادقة**: JWT (jsonwebtoken)
- **إدارة الحالة**: Zustand
- **مكتبات واجهة المستخدم**:
  - Radix UI (@radix-ui/react-\*)
  - Lucide React (أيقونات)
  - React Hot Toast (إشعارات)
  - Framer Motion (حركات)
  - NextUI

## تدفق العمل في التطبيق

1. **المصادقة**: تسجيل الدخول للمستخدمين وفقاً للصلاحيات
2. **إدارة المرضى**: تسجيل المرضى وإدارة بياناتهم
3. **قائمة الانتظار**: تنظيم دور المرضى
4. **طلب الفحوصات**: تعيين الفحوصات للمرضى
5. **إدارة العينات**: تسجيل العينات وتتبع نتائجها
6. **الفواتير**: إنشاء فواتير للخدمات المقدمة
7. **التقارير**: إنشاء تقارير متنوعة عن عمليات المختبر

## الصلاحيات والأدوار

- **المسؤول (ADMIN)**: وصول كامل لجميع الميزات
- **موظف الاستقبال (RECEPTIONIST)**: إدارة المرضى وقائمة الانتظار وإضافة الفحوصات
- **فني المختبر (LAB_TECHNICIAN)**: إدارة العينات ونتائج الفحوصات
- **المحاسب (ACCOUNTANT)**: إدارة الفواتير والتقارير المالية

## نقاط الواجهة البرمجية (API Endpoints)

### المصادقة

- `/api/auth/login`: تسجيل الدخول
- `/api/auth/register`: تسجيل مستخدم جديد

### المرضى

- `/api/patients`: إدارة المرضى
- `/api/patients/[id]`: مريض محدد
- `/api/patients/next-file-number`: الحصول على رقم ملف جديد
- `/api/patients/check-file-number`: التحقق من وجود رقم ملف

### الفحوصات

- `/api/tests`: إدارة الفحوصات

### العينات

- `/api/samples`: إدارة العينات

### الفواتير

- `/api/invoices`: إدارة الفواتير

### قائمة الانتظار

- `/api/queue`: إدارة قائمة الانتظار

### التقارير

- `/api/reports`: إدارة التقارير

### لوحة التحكم

- `/api/dashboard`: بيانات لوحة التحكم
